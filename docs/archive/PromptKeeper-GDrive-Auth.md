# PromptKeeper - Google Drive OAuth Configuration

**Last Updated**: December 8, 2024

---

## üìã OAuth Clients Overview

PromptKeeper uses **TWO separate OAuth clients** for Google Drive integration:

| Purpose | Client ID | Extension ID | Use When |
|---------|-----------|--------------|----------|
| **Local Testing** | `804678258987-e841cbt90rcba2pn5lgti5tn5cfm2t0t` | Local dev ID | Testing on your machine |
| **Published Version** | `804678258987-trop26ei3lek64gvdscchg2pfijo82mq` | `donmkahapkohncialmnkoofangooemjb` | Published on Chrome Web Store |

---

## üîß Client 1: Local Testing

### Configuration
```json
{
  "oauth2": {
    "client_id": "804678258987-e841cbt90rcba2pn5lgti5tn5cfm2t0t.apps.googleusercontent.com",
    "scopes": [
      "https://www.googleapis.com/auth/drive.file"
    ]
  }
}
```

### When to Use
- ‚úÖ Local development on your machine
- ‚úÖ Testing OAuth flow before publishing
- ‚úÖ Debugging Google Drive features
- ‚úÖ Running from `chrome://extensions/` (unpacked)

### Extension ID
- **Type**: Random, generated by Chrome (developer mode)
- **Changes**: Every time you reload/reinstall from different folder
- **Example**: `abcdefghijklmnopqrstuvwxyz123456`

### Test Users
- Must be added manually in Google Cloud Console
- OAuth Consent Screen ‚Üí Test Users ‚Üí Add your Gmail

---

## üöÄ Client 2: Published Version

### Configuration
```json
{
  "oauth2": {
    "client_id": "804678258987-trop26ei3lek64gvdscchg2pfijo82mq.apps.googleusercontent.com",
    "scopes": [
      "https://www.googleapis.com/auth/drive.file"
    ]
  }
}
```

### When to Use
- ‚úÖ Publishing to Chrome Web Store
- ‚úÖ Production releases (v2.0.1+)
- ‚úÖ All public users who install from Web Store
- ‚úÖ Final testing before release

### Extension ID
- **Published ID**: `donmkahapkohncialmnkoofangooemjb`
- **Type**: Permanent, assigned by Chrome Web Store
- **Changes**: Never (unless you unpublish and republish)

### Test Users
- No restrictions after publishing
- All Chrome users can authenticate

---

## üìù How to Switch Between Clients

### For Local Development
1. Open `manifest.json`
2. Use **Client 1**:
   ```json
   "client_id": "804678258987-e841cbt90rcba2pn5lgti5tn5cfm2t0t.apps.googleusercontent.com"
   ```
3. Reload extension in `chrome://extensions/`
4. Test OAuth flow

### For Publishing
1. Update `manifest.json` with **Client 2**:
   ```json
   "client_id": "804678258987-trop26ei3lek64gvdscchg2pfijo82mq.apps.googleusercontent.com"
   ```
2. Increment `version` in `manifest.json` (e.g., `2.0.0` ‚Üí `2.0.1`)
3. Package as ZIP
4. Upload to Chrome Web Store
5. Wait for approval

---

## üîê Security Notes

### Scopes Explained
```
https://www.googleapis.com/auth/drive.file
```
- **Access**: Only files created by PromptKeeper
- **Cannot**: Access user's existing Drive files
- **Cannot**: See folder structure outside app data

### Client Secrets
- Stored in: `client_secret_*.json` files in project root
- **‚ö†Ô∏è DO NOT COMMIT** these files to Git
- Add to `.gitignore`:
  ```
  client_secret_*.json
  ```

---

## üß™ Testing Checklist

### Before Local Testing
- [ ] Client 1 ID in `manifest.json`
- [ ] Extension reloaded in `chrome://extensions/`
- [ ] Your Gmail added as test user in OAuth consent screen
- [ ] Google Drive API enabled in Cloud Console

### Before Publishing
- [ ] Client 2 ID in `manifest.json`
- [ ] Version incremented
- [ ] Tested with Client 2 locally first (optional)
- [ ] Extension packaged as ZIP
- [ ] Chrome Web Store Developer Dashboard ready

---

## üõ†Ô∏è Google Cloud Console Links

### OAuth Credentials
https://console.cloud.google.com/apis/credentials

### OAuth Consent Screen
https://console.cloud.google.com/apis/credentials/consent

### Enable Google Drive API
https://console.cloud.google.com/apis/library/drive.googleapis.com

---

## üìä Current Configuration Status

| Component | Status | Client |
|-----------|--------|--------|
| `manifest.json` | ‚úÖ Configured | Client 1 (Local) |
| Google Cloud OAuth | ‚úÖ Both created | Client 1 + Client 2 |
| Chrome Web Store | ‚úÖ Published | Extension ID: `donmk...` |
| `GoogleDriveService.js` | ‚è≥ Pending | N/A |

---

## ‚ùì FAQ

**Q: Why two clients?**  
A: Local and published extensions have different IDs. Chrome's OAuth requires matching extension IDs.

**Q: Can I use Client 2 for local testing?**  
A: No. Client 2 is tied to the published extension ID (`donmk...`). Your local extension has a different ID.

**Q: What happens if I forget to switch clients before publishing?**  
A: OAuth will fail for all users. You'll need to resubmit with correct Client ID.

**Q: Can I delete Client 1 after publishing?**  
A: Not recommended. Keep it for future local development/testing.

**Q: How do I know which client is active?**  
A: Check `manifest.json` ‚Üí `oauth2.client_id`

---

## üö® Critical Reminders

1. **Never mix clients**: Local = Client 1, Published = Client 2
2. **Test before publishing**: Verify OAuth works with Client 2 locally
3. **Increment version**: Always bump version when changing manifests
4. **Keep secrets safe**: Don't commit `client_secret_*.json` files
5. **Client 2 only works after publishing**: Can't test Client 2 until extension has published ID

---

**Current Active Client** (as of manifest.json):
```
804678258987-e841cbt90rcba2pn5lgti5tn5cfm2t0t.apps.googleusercontent.com (Client 1 - Local)
```

**Published Client** (for next release):
```
804678258987-trop26ei3lek64gvdscchg2pfijo82mq.apps.googleusercontent.com (Client 2 - Published)
```
